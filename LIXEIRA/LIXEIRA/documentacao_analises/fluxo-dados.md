* na[ ] col1col2col3

# Relatório de Fluxo de Dados - SIGATA

**Connection string atual utilizada pelo backend (conforme .env):**
`postgresql://postgres:semil2025*@pli-db.c6j00cu4izbw.us-east-1.rds.amazonaws.com:5432/pli_db?sslmode=require`

Este relatório mapeia, por página HTML, cada valor exibido, seu elemento estrutural, o fluxo de dados desde o frontend até o banco de dados, detalhando endpoints, controllers e origem.

---

## 1. Página `index.html`

> **Connection string do banco (conforme docker-compose):** `postgresql://postgres:password@postgres:5432/sigata_db`

| Nome do Valor         | Elemento HTML                    | Função Frontend | Endpoint HTTP                        | Controller / Método                   | Descrição do Cálculo                              | Tipo da Origem     | Local da Fonte                           | Banco               | Esquema | Tabela               | Coluna            | URL Banco                                                      |
| --------------------- | -------------------------------- | ----------------- | ------------------------------------ | -------------------------------------- | ---------------------------------------------------- | ------------------ | ---------------------------------------- | ------------------- | ------- | -------------------- | ----------------- | -------------------------------------------------------------- |
| Documentos            | `<div id="totalDocs">`         | `loadStats()`   | `GET /api/metrics?period=30d`      | `MetricsController.getSystemMetrics` | `COUNT(*)` de todos os documentos                  | Banco de dados     | todos os registros de `documento_base` | SIGATA (PostgreSQL) | sigata  | documento_base       | _—_ (agregado) | `postgresql://<usuário>@<host>:5432/sigata?sslmode=require` |
| Processados           | `<div id="processedDocs">`     | `loadStats()`   | `GET /api/metrics?period=TODAY`    | `MetricsController.getTodayStats`    | `COUNT(*) WHERE status = 'completed'`              | Banco de dados     | `documento_base.status = 'completed'`  | SIGATA (PostgreSQL) | sigata  | documento_base       | status            | `postgresql://<usuário>@<host>:5432/sigata?sslmode=require` |
| Participantes         | `<div id="totalParticipants">` | `loadStats()`   | `GET /api/users/{id}/participants` | `UserController.countParticipants`   | `COUNT(*)` de participantes vinculados ao usuário | Banco de dados     | tabela `participante_reuniao`          | SIGATA (PostgreSQL) | sigata  | participante_reuniao | user_id           | `postgresql://<usuário>@<host>:5432/sigata?sslmode=require` |
| Taxa de Processamento | `<div id="processingRate">`    | `loadStats()`   | `GET /api/metrics?period=TODAY`    | `MetricsController.getTodayStats`    | `(processados / total) * 100`                      | Cálculo na camada | cálculo JS no `updateStats()`         | —                  | —      | —                   | —                | —                                                             |

---

## 2. Página `dashboard.html`

| Nome do Valor        | Elemento HTML                         | Função Frontend                                   | Endpoint HTTP                           | Controller / Método                  | Descrição do Cálculo                              | Tipo da Origem     | Local da Fonte                                               | Banco               | Esquema | Tabela            | Coluna                          | URL Banco                                                      |
| -------------------- | ------------------------------------- | --------------------------------------------------- | --------------------------------------- | ------------------------------------- | ---------------------------------------------------- | ------------------ | ------------------------------------------------------------ | ------------------- | ------- | ----------------- | ------------------------------- | -------------------------------------------------------------- |
| Meus Documentos      | `<div id="userTotalDocs">`          | `loadUserData()` → `updateUserMetrics()`       | `GET /api/usuarios/{id}/estatisticas` | `UsuarioController.getEstatisticas` | `COUNT(*)` de documentos enviados pelo usuário    | Banco de dados     | `documento_base.uploaded_by = :id`                         | SIGATA (PostgreSQL) | sigata  | documento_base    | uploaded_by                     | `postgresql://<usuário>@<host>:5432/sigata?sslmode=require` |
| Processados          | `<div id="userProcessedDocs">`      | idem                                                | idem                                    | idem                                  | `COUNT(*) WHERE status = 'processado'`             | Banco de dados     | `documento_base.status = 'processado'`                     | SIGATA (PostgreSQL) | sigata  | documento_base    | status                          | `postgresql://<usuário>@<host>:5432/sigata?sslmode=require` |
| Total Enviado (MB)   | `<div id="userUploadedSize">`       | idem                                                | idem                                    | idem                                  | `SUM(file_size) / (1024*1024)`                     | Banco de dados     | `JOIN documento_arquivo ON documento_base.id`              | SIGATA (PostgreSQL) | sigata  | documento_arquivo | file_size                       | `postgresql://<usuário>@<host>:5432/sigata?sslmode=require` |
| Taxa de Sucesso (%)  | `<div id="userSuccessRate">`        | idem                                                | idem                                    | idem                                  | `(processados / total) * 100`                      | Cálculo na camada | cálculo JS em `updateUserMetrics()`                       | —                  | —      | —                | —                              | —                                                             |
| Uploads Últimos 30d | `<canvas id="uploadsChart">`        | `loadDashboardData()` → `createUploadsChart()` | `GET /api/documents?userId={id}`      | `DocumentController.listByUser`     | agrupa por data de upload nos últimos 30 dias       | Banco de dados     | `documento_base.data_upload >= now() - interval '30 days'` | SIGATA (PostgreSQL) | sigata  | documento_base    | data_upload                     | `postgresql://<usuário>@<host>:5432/sigata?sslmode=require` |
| Status dos Docs      | `<canvas id="statusChart">`         | idem                                                | idem                                    | idem                                  | `COUNT(*) GROUP BY status`                         | Banco de dados     | agregação por `documento_base.status`                    | SIGATA (PostgreSQL) | sigata  | documento_base    | status                          | `postgresql://<usuário>@<host>:5432/sigata?sslmode=require` |
| Docs Recentes        | `<tbody id="recentDocumentsTable">` | `updateRecentDocuments()`                         | idem                                    | idem                                  | `LIMIT 5 ORDER BY documento_base.data_upload DESC` | Banco de dados     | ordenação de `documento_base.data_upload`                | SIGATA (PostgreSQL) | sigata  | documento_base    | data_upload, id, nome_arquivo   | `postgresql://<usuário>@<host>:5432/sigata?sslmode=require` |
| Atividade Recente    | `<div id="recentActivity">`         | `updateRecentActivity()`                          | idem                                    | idem                                  | derivado de data_upload/data_processamento           | Banco de dados     | `data_upload`, `data_processamento`                      | SIGATA (PostgreSQL) | sigata  | documento_base    | data_upload, data_processamento | `postgresql://<usuário>@<host>:5432/sigata?sslmode=require` |

---

## 3. Página `documents.html`

| Nome do Valor       | Elemento HTML                   | Função Frontend          | Endpoint HTTP          | Controller / Método             | Descrição do Cálculo               | Tipo da Origem | Local da Fonte                             | Banco               | Esquema | Tabela         | Coluna                                                  | URL Banco                                                      |
| ------------------- | ------------------------------- | -------------------------- | ---------------------- | -------------------------------- | ------------------------------------- | -------------- | ------------------------------------------ | ------------------- | ------- | -------------- | ------------------------------------------------------- | -------------------------------------------------------------- |
| Total de Documentos | `<div id="totalDocs">`        | `updateStatistics()`     | `GET /api/documents` | `DocumentController.listAll()` | `COUNT(*)` de todos os documentos   | Banco de dados | tabela `documento_base`                  | SIGATA (PostgreSQL) | sigata  | documento_base | id                                                      | `postgresql://<usuário>@<host>:5432/sigata?sslmode=require` |
| Processados         | `<div id="processedDocs">`    | idem                       | idem                   | idem                             | `FILTER status = 'completed'`       | Banco de dados | `documento_base.status`                  | SIGATA (PostgreSQL) | sigata  | documento_base | status                                                  | `postgresql://<usuário>@<host>:5432/sigata?sslmode=require` |
| Pendentes           | `<div id="pendingDocs">`      | idem                       | idem                   | idem                             | `FILTER status = 'processing'`      | Banco de dados | `documento_base.status`                  | SIGATA (PostgreSQL) | sigata  | documento_base | status                                                  | `postgresql://<usuário>@<host>:5432/sigata?sslmode=require` |
| Com Erro            | `<div id="errorDocs">`        | idem                       | idem                   | idem                             | `FILTER status = 'error'`           | Banco de dados | `documento_base.status`                  | SIGATA (PostgreSQL) | sigata  | documento_base | status                                                  | `postgresql://<usuário>@<host>:5432/sigata?sslmode=require` |
| Tabela de Docs      | `<tbody id="documentsTable">` | `updateDocumentsTable()` | idem                   | idem                             | itera registros JSON e popula colunas | Banco de dados | `documento_base` + `documento_arquivo` | SIGATA (PostgreSQL) | sigata  | documento_base | original_name, mimetype, file_size, uploaded_at, status | `postgresql://<usuário>@<host>:5432/sigata?sslmode=require` |

---

## 4. Página `analytics.html`

| Nome do Valor          | Elemento HTML                          | Função Frontend             | Endpoint HTTP         | Controller / Método           | Descrição do Cálculo                         | Tipo da Origem     | Local da Fonte                                 | Banco               | Esquema | Tabela                 | Coluna       | URL Banco                                                      |
| ---------------------- | -------------------------------------- | ----------------------------- | --------------------- | ------------------------------ | ----------------------------------------------- | ------------------ | ---------------------------------------------- | ------------------- | ------- | ---------------------- | ------------ | -------------------------------------------------------------- |
| Total Entidades        | `<div id="totalEntities">`           | `loadAnalyticsData()`       | `GET /api/analysis` | `AnalyticsController.list()` | `COUNT(entities)`                             | Banco de dados     | campo `entities` no JSON retornado           | SIGATA (PostgreSQL) | sigata  | documento_nlp_dados    | entities     | `postgresql://<usuário>@<host>:5432/sigata?sslmode=require` |
| Total Keywords         | `<div id="totalKeywords">`           | idem                          | idem                  | idem                           | `COUNT(keywords)`                             | Banco de dados     | campo `keywords` no JSON retornado           | SIGATA (PostgreSQL) | sigata  | documento_nlp_metricas | keywords     | `postgresql://<usuário>@<host>:5432/sigata?sslmode=require` |
| Sentimento Médio      | `<div id="avgSentiment">`            | idem                          | idem                  | idem                           | cálculo ponderado de `sentiments`            | Cálculo na camada | `analyticsData.sentiments`                   | —                  | —      | —                     | —           | —                                                             |
| Total Tópicos         | `<div id="totalTopics">`             | idem                          | idem                  | idem                           | `COUNT(topics)`                               | Banco de dados     | campo `topics` no JSON retornado             | SIGATA (PostgreSQL) | sigata  | documento_nlp_metricas | topics       | `postgresql://<usuário>@<host>:5432/sigata?sslmode=require` |
| Total Participantes    | `<div id="totalParticipants">`       | idem                          | idem                  | idem                           | `COUNT(participants)`                         | Banco de dados     | campo `participants` no JSON retornado       | SIGATA (PostgreSQL) | sigata  | documento_nlp_dados    | participants | `postgresql://<usuário>@<host>:5432/sigata?sslmode=require` |
| Gráfico Entidades     | `<canvas id="entitiesChart">`        | `createEntitiesChart()`     | idem                  | idem                           | exibe top 10 de `entities.value`              | Banco de dados     | `entities` retornado pela API                | SIGATA (PostgreSQL) | sigata  | documento_nlp_dados    | entities     | `postgresql://<usuário>@<host>:5432/sigata?sslmode=require` |
| Display Sentimentos    | `<div class="sentiment-item">…`     | `createSentimentDisplay()`  | idem                  | idem                           | exibe `analyticsData.sentiments[].percentage` | Banco de dados     | `sentiments` retornado pela API              | SIGATA (PostgreSQL) | sigata  | documento_nlp_metricas | sentiments   | `postgresql://<usuário>@<host>:5432/sigata?sslmode=require` |
| Gráfico Tópicos      | `<canvas id="topicsChart">`          | `createTopicsChart()`       | idem                  | idem                           | exibe `analyticsData.topics.count`            | Banco de dados     | `topics` retornado pela API                  | SIGATA (PostgreSQL) | sigata  | documento_nlp_metricas | topics       | `postgresql://<usuário>@<host>:5432/sigata?sslmode=require` |
| Gráfico Temporal      | `<canvas id="temporalChart">`        | `createTemporalChart()`     | —                    | —                             | dados estáticos definidos em código           | Código fonte      | arrays estáticos em `analytics.html`        | —                  | —      | —                     | —           | —                                                             |
| Gráfico Participantes | `<canvas id="participantsChart">`    | `createParticipantsChart()` | idem                  | idem                           | exibe `participants.mentions`                 | Banco de dados     | `participants` retornado pela API            | SIGATA (PostgreSQL) | sigata  | documento_nlp_dados    | participants | `postgresql://<usuário>@<host>:5432/sigata?sslmode=require` |
| Nuvem de Keywords      | `<div id="keywordCloud">`            | `createKeywordCloud()`      | idem                  | idem                           | exibe `keywords.word` com weight → font-size | Banco de dados     | `keywords` retornado pela API                | SIGATA (PostgreSQL) | sigata  | documento_nlp_metricas | keywords     | `postgresql://<usuário>@<host>:5432/sigata?sslmode=require` |
| Tabela Detalhada       | `<tbody id="detailedAnalysisTable">` | `updateDetailedTable()`     | idem                  | idem                           | itera `documents` retornado pela API          | Banco de dados     | `analyticsData.documents` retornado pela API | SIGATA (PostgreSQL) | sigata  | documento_nlp_dados    | documents    | `postgresql://<usuário>@<host>:5432/sigata?sslmode=require` |
